<!DOCTYPE HTML>
<html>

<head>
    <meta charset="UTF-8">
    <title>MyJozi Map Analyzer</title>
    <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../tachyons-ben.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="../../bower_components/leaflet/leaflet.css" />
    <link rel="stylesheet" href="../../bower_components/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet"
        href="../../bower_components/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css" />
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css'
        rel='stylesheet' />
    <link href="../css/sumoselect.css" rel="stylesheet" />
    <script type="text/javascript" src="../../bower_components/leaflet/leaflet.js"></script>
    <script type="text/javascript"
        src="../../bower_components/Leaflet.MultiOptionsPolyline/Leaflet.MultiOptionsPolyline.js"></script>
    <script type="text/javascript" src="js/myJozi.js"></script>
    <script type="text/javascript" src="../../bower_components/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="../../bower_components/moment/min/moment.min.js"></script>
    <script type="text/javascript" src="../../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript"
        src="../../bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js">
    </script>
    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js'>
    </script>
    <script src="lib/jquery.sumoselect.min.js"></script>
    <script src='//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js'></script>

    <script type="text/javascript">
        $(document).ready(function () {

            window.testSelAll = $('.testSelAll').SumoSelect({
                okCancelInMulti: true,
                selectAll: true
            });


        });
    </script>
    <style>
        @media (min-width: 2000px) {
            .map {
                height: 500px;
            }
        }

        @media (max-width: 2001px) {
            .map {
                height: 500px;
            }
        }

        div.row {
            margin-top: 16px;
        }
    </style>
</head>

<body>
    <section style="font-family: 'Lato', sans-serif;" class="">
        <div class="">
            <h1 class="tc pa3">MyJozi Map Analyser <small>Version 0.1</small></h1>
        </div>
        <div class="w-100 ph7 flex flex-wrap items-around justify-around ">
            <div class="w5 mr2">
                <label class="w5 tr">name of person/s</label>
                <select class="w5 no-focus-ring" id="Persons" multiple="multiple" placeholder="Select Person/s">
                    <!-- from 'surveyquestions' -->
                    <option value="6515aa2d583698f4">person 1</option>
                    <option value="9e1b4b8b3c61b1b5">person 2</option>
                    <option value="7dc91f154431ca6d">person 3</option>
                    <option value="ca55a878a058d274">person 4</option>
                    <option value="d55de76e2fc40737">person 5</option>
                    <option value="04b9b44a5afef988f">person 6</option>
                    <option value="91336ab4c96e32ff">person 7</option>
                    <!-- from 'myday' -->
                    <option value="4b9b44a5afef988f">person 8</option>
                    <option value="7431cbe2d2180c95">person 9</option>
                    <option value="63b4ca12ccb784b0">person 10</option>





                </select>
            </div>
            <div class="w5 mr2">
                <label class="w5 tr">transport mode</label>
                <select class="w5 tr no-focus-ring" id="mode">
                    <option value="All">All</option>
                    <option value="On Foot">Walking</option>
                    <option value="In Vehic">Vehicle</option>
                    <option value="On Bicyc">Cycling</option>
                    <option value="Still">Still</option>
                </select>
            </div>
            <div class="w5 mr2">
                <label class="w5 tr">race</label>
                <select class="w5 no-focus-ring" id="race" placeholder="Select Race" class="selectpicker">
                    <option value="All">All</option>
                    <option value="African">African</option>
                    <option value="Coloured">Coloured</option>
                    <option value="Indian/Asian">Indian/Asian</option>
                    <option value="White">White</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="w5 mr2">
                <label class="w5 tr">income</label>
                <select class="w5 no-focus-ring" id="income" placeholder="Select Income" class="selectpicker">
                    <option value="All">All</option>
                    <option value="R1 - R400">R1 - R400</option>
                    <option value="R401 - R800">R401 - R800</option>
                    <option value="R801 - R1 600">R801 - R1 600</option>
                    <option value="R1 601 - R3 200">R1 601 - R3 200</option>
                    <option value="R6 401 - R12 800">R6 401 - R12 800</option>
                    <option value="R12 801 - R19 200">R12 801 - R19 200</option>
                    <option value="R19 201 - R25 600">R19 201 - R25 600</option>
                    <option value="R25 601 - R38 400">R25 601 - R38 400</option>
                    <option value="R38 401 - R51 200">R38 401 - R51 200</option>
                    <option value="R51 201 - R76 800">R51 201 - R76 800</option>
                    <option value="R76 801 - R102 400">R76 801 - R102 400</option>
                    <option value="More">More</option>
                    <option value="No Income">No Income</option>
                </select>
            </div>
            <div class="w5 mr2">
                <label class="w5 tr">employment</label>
                <select class="w5 no-focus-ring" id="employment" placeholder="Select Employment" class="selectpicker">
                    <option value="All">All</option>
                    <option value="Not currently employed">Not currently employed</option>
                    <option value="Employed full time, formal sector">Employed full time, formal sector</option>
                    <option value="Employed part time, formal sector">Employed part time, formal sector</option>
                    <option value="Employed full time, informal sector">Employed full time, informal sector</option>
                    <option value="Employed part time, informal sector">Employed part time, informal sector</option>
                    <option value="Self-employed, own business, NOT working from home">Self-employed, own business,
                        NOT working from home</option>
                    <option value="Self-employed, own business, working from home">Self-employed, own business,
                        working from home</option>
                </select>
            </div>
            <div class="w5 mr2 ">
                <label class="w5 tr">city</label>
                <select class="w5 no-focus-ring" id="city" placeholder="Select Municipality" class="selectpicker">
                    <option value="All">All</option>
                    <option value="Johannesburg">Johannesburg</option>
                    <option value="Ekurhuleni">Ekurhuleni</option>
                    <option value="Tshwane">Tshwane</option>
                    <option value="Sedibeng">Sedibeng</option>
                    <option value="West Rand">West Rand</option>
                    <option value="Metsweding">Metsweding</option>
                </select>
            </div>

        </div>
        <div class=" w-100 ph7 mt4 flex justify-center">

            <div class="w5 mh5 ">
                <label class="w5 tr" for="fromDate">from date:</label>
                <input class="b--solid br4 b--black-40 bg-black-10 w5 ph3 no-focus-ring" type="date" id="fromDate"
                    value="2016-09-09" name="fromDate">
            </div>
            <div class="w5 mh5">
                <label class="w5 tr" for="toDate">to date:</label>
                <input class="b--solid br4 b--black-40 bg-black-10 w5 ph3 no-focus-ring" type="date" id="toDate"
                    value="2016-10-15" name="toDate">
            </div>
            <button
                class="w-30 mh5 b--solid br4 b--gray mt4 ph5 f-4 bg-black-50 white-90 hover-bg-silver grow no-focus-ring"
                id="btnFilter" onclick="myFunction()">Filter</button>


        </div>
    </section>
    <br>

    <div class="col-md-12 col-sm-12">
        <div id="map1" class="map"></div>
    </div>







    <script>
        function myFunction() {

            options = document.querySelectorAll('#Persons option');
            let androidIds = [];
            for (var i = options.length; i--;) {
                if (options[i].selected) androidIds.push(options[i].value)
            }

            var mode = document.querySelector("#mode").value;
            var race = document.querySelector('#race').value;
            var income = document.querySelector('#income').value;
            var employment = document.querySelector('#employment').value;
            var city = document.querySelector('#city').value;
            var fromDate = document.querySelector("#fromDate").value;
            var toDate = document.querySelector("#toDate").value;

            $.ajax({
                url: '../../myjozigeojson.php',
                type: "POST",
                data: {
                    'androidids': androidIds,
                    'fromDate': fromDate,
                    'toDate': toDate,
                    'mode': mode,
                    'race': race,
                    'income': income,
                    'employment': employment,
                    'city': city
                },
                dataType: "json",
                success: function (result) {

                    if (result.length >= 1) {
                        jsonData = result;
                        console.log('SUCCESS:' + JSON.stringify(jsonData));
                        draw(jsonData);
                    } else {
                        alert("Sorry, no dataset found!");

                    }
                }
            });
        }
    </script>
</body>

</html>